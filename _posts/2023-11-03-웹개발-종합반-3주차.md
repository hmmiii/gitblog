---
title: 웹개발 종합반 3주차
author: hmmi
date: 2023-11-03 14:28
categories: [항해99,웹개발종합반]
tags: [항해99,웹개발종합반]
pin: true
toc: true
toc_sticky: true
---

## 3주차 배운 내용

- 파이썬 기초 문법

- 웹 스크래핑

- flask 개발

3주차에서는 파이썬의 기본 문법, 웹 스크래핑을 통해 사이트 긁어오기, flask로 백엔드 개발 맛보기(?) 였다. 간단한 API 제작 등을 경험해 볼 수 있었다.

## 파이썬 자료형

자료형을 입문 강의여서 그런지 기본 몇가지만 소개해주셔서, gpt로 모든 자료형을 알려달라고 해보았다.

### 정수형 (int):

정수 값을 나타내는 자료형입니다. 양수, 음수, 0을 모두 표현할 수 있습니다.

예: `x = 10`

### 부동 소수점 숫자 (float):

실수 값을 나타내는 자료형으로 소수점을 포함할 수 있습니다.

예: `x = 3.14`

### 문자열 (str):

문자열은 문자의 시퀀스로 텍스트 데이터를 나타냅니다. 작은 따옴표 (')나 큰 따옴표 (")로 둘러싸여 있습니다.

예: `name = "Alice"`

### 부울 (bool):

참(True) 또는 거짓(False) 값을 나타내는 자료형입니다.

조건문 및 논리 연산에 사용됩니다.

예: `is_valid = True`

### 리스트 (list):

요소의 시퀀스를 저장하는 자료구조로, 서로 다른 데이터 유형을 포함할 수 있습니다.

예: `numbers = [1, 2, 3]`

### 튜플 (tuple):

불변한 요소의 시퀀스를 저장하는 자료구조로, 변경할 수 없는 특성을 가집니다.

예: `coordinates = (2, 3)`

### 딕셔너리 (dict):

키-값 쌍을 저장하는 자료구조로, 키를 사용하여 값을 찾을 수 있습니다.

예: `person = {'name': 'Alice', 'age': 30}`

### 집합 (set):

중복 요소 없이 고유한 값을 저장하는 자료구조입니다.

예: `unique_numbers = {1, 2, 3}`

## 파이썬 조건문

파이썬은 기본적으로 들여쓰기 기반 언어이다. 콜론(:)이후 다음 행에서 들여쓰기를 하느냐 안 하느냐에 따라 블록이 나뉜다고 보면 된다. 때문에, JS에서는 몇칸을 띄워쓰던, 상관이 없었으나 파이썬에서는 들여쓰기에 민감하다. 문법에 속하기 때문이겠다.

```py
if 1 < 3:
    print('3은 1보다 큽니다.')
```
이런 식으로 사용한다. 조건 안에 ()도 사용하지 않는다.

그렇다면 다른 케이스가 존재한다면? 파이썬에는 아쉽게도 switch문은 존재하지 않는다. elif를 사용한다.

```py
if 3 < 1:
    print('1은 3보다 큽니다.')
elif 4 > 1:
    print('4는 1보다 큽니다.')
```
주의할 점은, elif는 앞의 if가 맞는다면 실행되지 않는다. 그렇다면, 모두 틀리다면? else를 사용한다.

```py
if 3 < 1:
    print('1은 3보다 큽니다.')
elif 4 < 1:
    print('1는 4보다 큽니다.')
else:
    print('0 음수도 양수도 아닙니다.')
```
else는 앞의 조건이 모두 틀렸을 때 실행된다.

## 파이썬 반복문

반복문 역시, 들여쓰기 기반으로 작성한다. JS에는 배열 기반 forEach() 함수가 있는데, 딱히 그런 함수가 있진 않고 in 키워드를 사용하면 배열을 순회한다. JS로 보자면 for ... of와 비슷하다.

```py
fruits = ['사과','배','감','귤'] # fruits라는 과일 값이 담긴 리스트
# fruits라는 리스트의 요소를 돌아가면서 반복할건데, 
# 그 요소 중 하나를 fruit라고 할게요. fruit는 순서대로 사과/배/감/귤 이 됩니다
for fruit in fruits:
	print(fruit)

# 사과, 배, 감, 귤 하나씩 꺼내어 찍힙니다.
```

파이썬은 여러 형식의 for을 지원한다. range 함수를 이용하면,  몇 회 돌 것인지 설정이 가능하다. 

```py
loopNum = 5

for i in range(loopNum):
    print('loop!!')
```
range는 파라미터로 start, stop, step 값을 받기 때문에 다양한 반복을 구현해볼 수 있다.

### start 만 사용

```py
for i in range(5):
    print(i)
# 출력: 0, 1, 2, 3, 4
```

### start, stop 사용

stop-1 까지 돈다.
```py
for i in range(2, 5):
    print(i)
# 출력: 2, 3, 4
```

### start, stop, step 사용

step의 경우, 건너뛸 숫자를 지정한다. 라고 하는데, 보다는 +할 숫자를 넣는다고 보는 게 이해가 쉬웠다. 예를 들어, 초기 값이 1이니까 다음 값은 1+2한 3이다.

```py
for i in range(1, 10, 2):
    print(i)
# 출력: 1, 3, 5, 7, 9
```

## 함수

파이썬에도 함수가 존재한다. 역시 들여쓰기 기반으로 선언하고, 사용한다.
```py
# 헤이를 출력하는 함수 만들기 (재료가 없는 함수)
def hey(): # 함수를 선언(만들기)할 때는, 항상 뒤에 콜론(:)까지 써주세요!
	print("헤이") # 함수가 작동하는 코드는 항상 들여쓰기를 해주세요!

hey() # "헤이"를 출력하는 함수=기계 hey() 작동시키기

# a,b,c 라는 세 숫자를 더하는 함수 만들기
def sum(a,b,c): # 요리을 만들 때, 재료를 넣듯이 꼭 필요한 요소를 명시
	return a+b+c

# 함수 호출 및 변수에 저장
# 함수를 작동시키고 내보내는 결과물을 result라는 변수에 담는다
result = sum(1,2,3)
print(result)
```

## 가상환경 생성하기

파이썬을 개인적으로 공부했을 때는 몰랐던 개념인데, 가상환경을 통해서 라이브러리 설치 시 충돌을 예방할 수 있다.

예를 들어 app1.py라는 프로그램은 어떤 라이브러리 2.0버전을 사용하고, 업데이트 시 문제가 발생하는데, app2.py라는 프로그램은 업데이트를 해야 되는 프로그램이라고 할 때, 가상환경을 사용하면 충돌 없이 두 프로그램 사용이 가능하겠다.

강의에서는 vscode의 기능을 이용해 가상환경을 생성했는데, 터미널을 이용한 방법이 더 용이해보였다. 특히 문제가 발생했는데, 해당 방식으로는 각 폴더마다 만드는 게 어려웠다.

**MAC 기준이다.**

가상환경 폴더명은 항상 .venv로 하면, 작명 고민이 필요 없다. 터미널 위치가 해당 폴더라면, 항상 새로 가상환경을 만들고, 항상 내가 있는 폴더의 가상환경을 활성화 할 수 있다.

```bash
python3 -m venv .venv
source .venv/bin/activate
```

## 웹 스크래핑

requests, bs4 라이브러리를 이용하면, 웹 스크래핑을 할 수 있다. 웹 스크래핑이란, 사이트에서 내용을 긁어올 수 있는 기술이다. 이를 이용하면 재미있는 사이트들을 만들 수 있을 것 같다.

- requests는 여러 http 요청을 보낼 수 있는 라이브러리이다. 사이트를 긁어오려면, 우선 해당 사이트에 get 요청을 보내야 하기 때문에 필요하다.

- bs4는 해당 사이트에서 css 선택자를 활용해서 내용을 긁어올 수 있는 라이브러리이다.

### 설치

```bash
pip install requests bs4
```

### html 파싱

이렇게 하면, 이제 soup 이라는 변수에 BeautifulSoup 클래스의 인스턴스를 생성하는데, 이때 가져온 html 정보를 바탕으로 html을 파싱한 것이다. soup 변수를 이용해서 이제 사이트의 여러가지 정보들을 가져올 수 있다.

```py
import requests
from bs4 import BeautifulSoup

URL = "https://search.naver.com/search.naver?where=nexearch&sm=top_hty&fbm=0&ie=utf8&query=날씨"
headers = {'User-Agent' : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64)AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.86 Safari/537.36'}
data = requests.get(URL, headers=headers)
soup = BeautifulSoup(data.text, 'html.parser')
```

### 요소 선택하기

내용을 긁어오려면, 우선 선택해야한다.

#### id 선택자를 사용하는 방법 (copy selector)

```py
soup.select('태그명')
soup.select('.클래스명')
soup.select('#아이디명')

soup.select('상위태그명 > 하위태그명 > 하위태그명')
soup.select('상위태그명.클래스명 > 하위태그명.클래스명')

# 태그와 속성값으로 찾는 방법
soup.select('태그명[속성="값"]')

# 한 개만 가져오고 싶은 경우
soup.select_one('위와 동일')
```

### 텍스트 가져오기

temp에 온도 정보가 있는 html 요소 클래스를 선택했다.

```py
temp = soup.select_one('.temperature_text')
.text를 이용해서, text를 가져올 수가 있다.

temp = soup.select_one('.temperature_text')
print(temp.text)
```

## Flask

플라스크는 간단하게 웹서버를 만들고, 라우팅, API 제작 등을 해볼 수 있는 라이브러리이다.

### 설치

```bash
pip install flask
```

### 폴더 구조

라우팅을 위해서 폴더 구조를 따라야 한다.

flask
|— venv
|— app.py (서버)
|— templates
         |— index.html (클라이언트 파일)

### flask 시작 코드

```py
from flask import Flask
app = Flask(__name__)

@app.route('/')
def home():
    return 'This is Home!'

if __name__ == '__main__':  
    app.run(debug=True)
```

### 서버 시작

서버 시작은 별거 없다. 그냥 파이썬 파일을 실행하면 된다. 그러면 콘솔창에 나의 서버 주소가 뜨는데, 이 기본적인 서버의 경우 루트(/) 디렉토리에 가면 'This is Home' 이라는 텍스트를 보여준다.

```bash
python3 app.py
```

### 라우팅

루트 디렉토리 이외에 다른 곳으로 갔을 때 보여줄 내용을 추가해보자.

```py
from flask import Flask
app = Flask(__name__)

@app.route('/')
def home():
   return 'This is Home!'

@app.route('/mypage')
def mypage():  
   return 'This is My Page!'

if __name__ == '__main__':  
   app.run(debug=True)
```

/mypage로 이동하면, 'This is My Page!'라는 텍스트를 보여주는 사이트가 됐다.

#### templates 폴더의 파일로 라우팅

templates 폴더 안의 내용을 보내줄 수도 있다. render_template 함수를 import 하고, 파일명을 입력한다.

```py
from flask import Flask, render_template
app = Flask(__name__)

## URL 별로 함수명이 같거나,
## route('/') 등의 주소가 같으면 안됩니다.

@app.route('/')
def home():
   return render_template('index.html')

@app.route('/mypage')
def mypage():
	return 'This is My page!'

if __name__ == "__main__":
    app.run(debug=True)

```
### 템플릿 렌더링

백엔드에서 데이터를 프론트엔드로 전달하여 표시하는 것은 "템플릿 렌더링" 또는 "템플릿 엔진 사용"이라고 한다.

render_template 함수의 두 번째 파라미터로 변수를 넘겨주면 된다.

```py
@app.route('/')
def home():
    name = "최지웅"
    return render_template('index.html', data=name)
```

그러면 템플릿 파일에서 {{ }} 안에 넣어 보여줄 수 있다.

```html
<body>
    <h1>안녕, {{ data }}</h1>
</body>
```

#### 데이터 여러 개 넘겨 주기

일반적으로는 데이터가 여러 개 넘어 갈텐데, 이럴 때는 딕셔너리 자료형을 넘겨주면 된다.


```py
@app.route('/')
def home():
    name = "최지웅"
    lotto = [16, 18, 20, 23, 32, 43]

    context = {
        "name": name,
        "lotto": lotto,
    }
    return render_template('index.html',  data=context)
```


템플릿에서는 이렇게 사용한다.

```html
<body>
    <h1>안녕, {{ data.name }}</h1>
    <h2>로또 번호: {{ data.lotto }}</h2>
</body>
```
### 이미지 삽입하기

이미지를 삽입하려면, 폴더 구조에 static/image 폴더를 추가해주면 된다.

flask
|— venv
|— app.py (서버)
|— templates
         |— index.html (클라이언트 파일)
|— static
         |— image

템플릿 파일에서 이런 식으로 가져온다.

```html
<img src="{{ url_for('static', filename='image/coinman.png') }}" alt="">
```

### API 만들기

API를 만들 수도 있다. 간단하게 form 태그를 이용해서 action attr에 담아 get 요청 및 post 요청을 처리하는 API를 만들려면 이렇게 가능하다.

```py
from flask import Flask, request

app = Flask(__name)

@app.route('/example', methods=['GET', 'POST'])
def example():
    if request.method == 'GET':
        # GET 요청에서 쿼리스트링을 추출
        query_string = request.args.get('key')
        return f'Query String: {query_string}'
    elif request.method == 'POST':
        # POST 요청에서 폼 데이터 처리
        form_data = request.form['key']
        return f'Form Data: {form_data}'

if __name__ == '__main__':
    app.run()
```

이 API에는 GET 요청일 경우와 POST 요청일 경우가 모두 정의 되어 있어서, 템플릿에서는 method만 설정해주면 된다. 정의 부분을 보면, GET 요청일 때는 쿼리 스트링을 추출하고, POST 요청일 때는 data를 추출한다.

아래는 GET 요청을 보낼 때다.

```html
<form action="/example" method="GET">
	<label for="key">Enter a key:</label>
	<input type="text" id="key" name="key">
	<input type="submit" value="Submit">
</form>
```